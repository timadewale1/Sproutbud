<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Projects - SproutBud</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/Media/Logo/IMG_2381.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/Media/Logo/IMG_2381.png">
    <link rel="apple-touch-icon" href="/Media/Logo/IMG_2381.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Inter:wght@300;400;500&display=swap"
        rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        sprout: {
                            green: '#32A65A',
                            forest: '#1E5B3A',
                            blue: '#3A8DFF',
                            deep: '#1D3557',
                            brown: '#A67C52',
                            earth: '#6B4F33',
                        }
                    },
                    fontFamily: {
                        heading: ['Manrope', 'sans-serif'],
                        body: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-sprout-green-50 font-body">
    <custom-navbar></custom-navbar>

    <!-- Page Header -->
    <section class="relative bg-gradient-to-r from-sprout-forest to-sprout-deep text-white py-24 px-6">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-heading font-bold mb-6 text-center justify-center align-middle">Our Projects</h1>
            <p class="text-xl max-w-2xl mx-auto text-center">
                Explore our initiatives creating tangible impact across African communities.
            </p>
        </div>
        <div class="absolute bottom-0 left-0 right-0 h-16 bg-white/10 backdrop-blur-sm"></div>
    </section>

    <!-- Project Filters -->
    <!-- <section class="py-12 px-6 bg-white">
        <div class="max-w-6xl mx-auto">
            <div class="flex flex-wrap gap-4 justify-center">
                <button class="px-6 py-2 rounded-full bg-sprout-green text-white font-medium">All</button>
                <button
                    class="px-6 py-2 rounded-full bg-sprout-green-100 text-sprout-green font-medium hover:bg-sprout-green-200 transition">Technology</button>
                <button
                    class="px-6 py-2 rounded-full bg-sprout-green-100 text-sprout-green font-medium hover:bg-sprout-green-200 transition">Agriculture</button>
                <button
                    class="px-6 py-2 rounded-full bg-sprout-green-100 text-sprout-green font-medium hover:bg-sprout-green-200 transition">Education</button>
                <button
                    class="px-6 py-2 rounded-full bg-sprout-green-100 text-sprout-green font-medium hover:bg-sprout-green-200 transition">Women</button>
                <button
                    class="px-6 py-2 rounded-full bg-sprout-green-100 text-sprout-green font-medium hover:bg-sprout-green-200 transition">Energy</button>
            </div>
        </div>
    </section> -->

    <!-- Projects Grid -->
    <section class="py-20 px-6">
        <div class="max-w-6xl mx-auto">
            <div id="projects-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
            <div id="projects-pagination" class="mt-8 flex items-center justify-center gap-3"></div>
        </div>
    </section>

    <script>
    (function(){
      const perPage = 6;
      let projects = [];
      let manifest = {};
      function normalize(s){ return (s||'').toString().toLowerCase().replace(/[^a-z0-9]+/g,''); }
            function findMediaFolderFor(title){
                const t = (title||'').toString().toLowerCase();
                // direct substring matches
                for(const key of Object.keys(manifest||{})){
                    if(!key) continue;
                    const k = key.toString().toLowerCase();
                    if(k.indexOf(t)!==-1 || t.indexOf(k)!==-1) return key;
                }
                // token intersection matching (better for titles vs folder names)
                const tTokens = new Set(t.split(/[^a-z0-9]+/).filter(Boolean));
                for(const key of Object.keys(manifest||{})){
                    const kTokens = new Set(key.toString().toLowerCase().split(/[^a-z0-9]+/).filter(Boolean));
                    let common = 0;
                    kTokens.forEach(tok=>{ if(tTokens.has(tok)) common++; });
                    if(common>0) return key;
                }
                // special mappings for known folders
                const map = {
                    'digital literacy': 'TechNest - Students Training',
                    'ict for change': 'TechNest - Students Training',
                    'technest': 'TechNest - Students Training',
                    'world cleanup 2025': 'World Cleanup Day 2025',
                    'young women launchpad': 'Young Women Launchpad'
                };
                for(const k of Object.keys(map)){
                    if(t.indexOf(k)!==-1 && manifest[map[k]]) return map[k];
                }
                return null;
            }

      function getIconFor(title){
        const t = title.toLowerCase();
        if(t.includes('tech')||t.includes('digital')||t.includes('ict')||t.includes('code')) return 'zap';
        if(t.includes('women')||t.includes('girl')) return 'users';
        if(t.includes('solar')||t.includes('energy')) return 'sun';
        if(t.includes('podcast')||t.includes('audio')) return 'mic';
        if(t.includes('research')||t.includes('publication')) return 'book-open';
        if(t.includes('agri')||t.includes('farm')||t.includes('farming')) return 'leaf';
        if(t.includes('school')||t.includes('education')) return 'book';
        return 'folder';
      }

      function renderPage(page){
        const start = (page-1)*perPage;
        const slice = projects.slice(start, start+perPage);
        const grid = document.getElementById('projects-grid');
        grid.innerHTML = '';
        slice.forEach(p=>{
          const hasMedia = !!p.mediaFolder && manifest[p.mediaFolder] && manifest[p.mediaFolder].length;
          const col = document.createElement('div');
          col.className = 'bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-xl transition duration-300 card';
          const top = document.createElement('div');
          top.className = 'h-48 bg-sprout-green-900 flex items-center justify-center';
          if(hasMedia){
            const img = document.createElement('img');
            img.className = 'w-full h-full object-cover';
            const imgName = manifest[p.mediaFolder][0];
            img.src = '/Media/' + encodeURIComponent(p.mediaFolder) + '/' + encodeURIComponent(imgName);
            img.alt = p.title;
            top.appendChild(img);
          } else {
            const i = document.createElement('i'); i.setAttribute('data-feather', getIconFor(p.title)); i.className='w-12 h-12 text-white';
            top.appendChild(i);
          }
          col.appendChild(top);

          const body = document.createElement('div'); body.className='p-6';
          const title = document.createElement('h3'); title.className='text-xl font-heading font-bold text-sprout-deep mb-3'; title.textContent = p.title;
          const desc = document.createElement('p'); desc.className='text-gray-600 text-sm mb-4'; desc.textContent = p.description || '';
          const a = document.createElement('a'); a.href = p.url; a.className='text-sprout-green hover:text-sprout-forest text-sm font-medium flex items-center'; a.innerHTML = 'Go to project <i data-feather="arrow-right" class="ml-2 w-4 h-4"></i>';
          body.appendChild(title); body.appendChild(desc); body.appendChild(a);
          col.appendChild(body);
          grid.appendChild(col);
        });
        // replace feather icons in new nodes
        if(window.feather && window.feather.replace) window.feather.replace();
        renderPagination();
      }

      function renderPagination(){
        const total = projects.length; const pages = Math.ceil(total/perPage);
        const container = document.getElementById('projects-pagination');
        container.innerHTML = '';
        const current = parseInt(container.getAttribute('data-page')||'1',10);
        const prev = document.createElement('button'); prev.className='btn btn-outline'; prev.textContent='Previous'; prev.disabled = current<=1; prev.addEventListener('click',()=>{ container.setAttribute('data-page', current-1); renderPage(current-1); });
        container.appendChild(prev);
        for(let i=1;i<=pages;i++){
          const b=document.createElement('button'); b.className='btn'; b.textContent = i; if(i===current) b.className+=' btn-primary'; b.addEventListener('click',()=>{ container.setAttribute('data-page', i); renderPage(i); }); container.appendChild(b);
        }
        const next = document.createElement('button'); next.className='btn btn-outline'; next.textContent='Next'; next.disabled = current>=pages; next.addEventListener('click',()=>{ container.setAttribute('data-page', current+1); renderPage(current+1); }); container.appendChild(next);
      }

      Promise.all([fetch('/data/projects-list.json').then(r=>r.json()), fetch('/Media/manifest.json').then(r=>r.json())]).then(([plist, m])=>{
        manifest = m || {};
        // annotate projects with media presence and optional description
        projects = plist.map(p=>({ title: p.title, url: p.url, description: p.description || '', mediaFolder: p.mediaFolder || findMediaFolderFor(p.title) }));
        // sort: media first
        projects.sort((a,b)=>{ const aHas = !!(a.mediaFolder && manifest[a.mediaFolder] && manifest[a.mediaFolder].length); const bHas = !!(b.mediaFolder && manifest[b.mediaFolder] && manifest[b.mediaFolder].length); return (aHas===bHas)? a.title.localeCompare(b.title): (aHas? -1: 1); });
        // init pagination
        const container = document.getElementById('projects-pagination'); container.setAttribute('data-page','1');
        renderPage(1);
      }).catch(err=>{ console.error('Failed to load projects or media manifest', err); });
    })();
    </script>

            <!-- <div class="text-center mt-12">
                <button
                    class="bg-sprout-green hover:bg-sprout-forest text-white px-8 py-3 rounded-full font-medium transition duration-300">
                    Load More Projects
                </button>
            </div> -->
        </div>
    </section>

    <custom-footer></custom-footer>

    <script src="components/navbar.js"></script>
    <script src="components/footer.js"></script>
    <script src="script.js"></script>
    <script>
        feather.replace();
    </script>
</body>

</html>